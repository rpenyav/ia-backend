<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>{{title}}</title>
  <link rel="stylesheet" href="/static/backoffice.css" />
</head>
<body>
  <div class="layout">
    <header>
      <div>
        <h1>{{title}}</h1>
        <p>Gesti√≥n de variables de entorno desde BBDD</p>
      </div>
      <nav>
        <a href="/backoffice">üìä Dashboard</a>
        <a href="/backoffice/users">üë§ Usuarios</a>
        <a href="/backoffice/settings">‚öôÔ∏è Settings</a>
        <a href="/backoffice/env"><strong>üå± Env vars</strong></a>

        <form method="POST" action="/backoffice/logout" style="display:inline;">
          <button type="submit" class="btn-link" style="margin-left: 12px;">Salir</button>
        </form>
      </nav>
    </header>

    <section class="card">
      <h2>Variables de entorno</h2>

      <form method="GET" action="/backoffice/env" class="filters">
        <div class="row">
          <div class="field">
            <label>Buscar por clave o descripci√≥n</label>
            <input
              type="text"
              name="q"
              value="{{q}}"
              placeholder="ej: DEFAULT_LLM_PROVIDER"
            />
          </div>

          <div class="field">
            <button type="submit" class="btn-primary">Buscar</button>
            <a href="/backoffice/env" class="btn-link">Limpiar</a>
          </div>
        </div>
      </form>

      {{#if envVars.length}}
        <table>
          <thead>
            <tr>
              <th>Clave</th>
              <th>Valor</th>
              <th>Descripci√≥n</th>
              <th>Secreto</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody>
            {{#each envVars}}
              <tr>
                <td><code>{{this.key}}</code></td>
                <td>
                  {{#if this.isSecret}}
                    <span class="muted">‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢ (secreto)</span>
                  {{else}}
                    <code>{{this.value}}</code>
                  {{/if}}
                </td>
                <td>{{this.description}}</td>
                <td>
                  {{#if this.isSecret}}
                    S√≠
                  {{else}}
                    No
                  {{/if}}
                </td>
                <td>
                  <a href="/backoffice/env/{{this.id}}/edit">Editar</a>

                  <form
                    method="POST"
                    action="/backoffice/env/{{this.id}}/delete"
                    style="display:inline;"
                    onsubmit="return confirm('¬øSeguro que quieres borrar esta variable?');"
                  >
                    <button type="submit" class="btn-link">Borrar</button>
                  </form>
                </td>
              </tr>
            {{/each}}
          </tbody>
        </table>
      {{else}}
        <p class="muted">No hay variables (o no coinciden con la b√∫squeda).</p>
      {{/if}}
    </section>
  </div>
</body>
</html>
